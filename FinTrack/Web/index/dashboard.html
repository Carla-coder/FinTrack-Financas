<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestão Financeira</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      body {
        font-family: "Arial", sans-serif;
        background-color: #f4f4f4;
      }
      .app-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .card {
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .btn-add {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
      }
    </style>
  </head>

  <body>
    <div class="app-container">
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Gestão Financeira</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  aria-current="page"
                  href="dashboard.html"
                  >Dashboard</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="transacoes.html">Transações</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="orcamentos.html">Orçamentos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="relatorios.html">Relatórios</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="row">
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Saldo Atual</h5>
              <h2 class="card-text text-success">R$ 5.234,56</h2>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Gastos do Mês</h5>
              <h2 class="card-text text-danger">R$ 2.145,30</h2>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-8">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Fluxo de Caixa</h5>
              <canvas id="cashFlowChart"></canvas>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Categorias de Gastos</h5>
              <canvas id="expensePieChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Últimas Transações</h5>
          <table class="table" id="transactionTable">
            <thead>
              <tr>
                <th>Data</th>
                <th>Descrição</th>
                <th>Categoria</th>
                <th>Valor</th>
              </tr>
            </thead>
            <tbody id="transactionTableBody">
              <tr>
                <td>10/06/2023</td>
                <td>Supermercado</td>
                <td>Alimentação</td>
                <td class="text-danger">-R$ 250,00</td>
              </tr>
              <tr>
                <td>08/06/2023</td>
                <td>Salário</td>
                <td>Renda</td>
                <td class="text-success">+R$ 3.500,00</td>
              </tr>
              <tr>
                <td>05/06/2023</td>
                <td>Conta de Luz</td>
                <td>Utilidades</td>
                <td class="text-danger">-R$ 120,00</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <button
        class="btn btn-primary btn-lg rounded-circle btn-add"
        data-bs-toggle="modal"
        data-bs-target="#addTransactionModal"
      >
        +
      </button>
    </div>

    <!-- Modal para adicionar transação -->
    <div
      class="modal fade"
      id="addTransactionModal"
      tabindex="-1"
      aria-labelledby="addTransactionModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addTransactionModalLabel">
              Adicionar Transação
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="transactionForm">
              <div class="mb-3">
                <label for="transactionDate" class="form-label">Data</label>
                <input
                  type="date"
                  class="form-control"
                  id="transactionDate"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="transactionDescription" class="form-label"
                  >Descrição</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="transactionDescription"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="transactionCategory" class="form-label"
                  >Categoria</label
                >
                <select class="form-select" id="transactionCategory" required>
                  <option value="">Selecione uma categoria</option>
                  <option value="income">Renda</option>
                  <option value="food">Alimentação</option>
                  <option value="transport">Transporte</option>
                  <option value="utilities">Utilidades</option>
                  <option value="entertainment">Entretenimento</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="transactionAmount" class="form-label">Valor</label>
                <input
                  type="number"
                  class="form-control"
                  id="transactionAmount"
                  step="0.01"
                  required
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="saveTransactionButton"
            >
              Salvar
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Gráfico de Fluxo de Caixa
        const cashFlowCtx = document
          .getElementById("cashFlowChart")
          .getContext("2d");
        new Chart(cashFlowCtx, {
          type: "line",
          data: {
            labels: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun"],
            datasets: [
              {
                label: "Entradas",
                data: [3000, 3200, 3100, 3500, 3300, 3700],
                borderColor: "rgba(75, 192, 192, 1)",
                tension: 0.1,
              },
              {
                label: "Saídas",
                data: [2500, 2700, 2600, 2800, 2900, 3000],
                borderColor: "rgba(255, 99, 132, 1)",
                tension: 0.1,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });

        // Gráfico de Pizza de Categorias de Gastos
        const expensePieCtx = document
          .getElementById("expensePieChart")
          .getContext("2d");
        new Chart(expensePieCtx, {
          type: "pie",
          data: {
            labels: [
              "Alimentação",
              "Transporte",
              "Moradia",
              "Entretenimento",
              "Outros",
            ],
            datasets: [
              {
                data: [30, 20, 25, 15, 10],
                backgroundColor: [
                  "rgba(255, 99, 132, 0.8)",
                  "rgba(54, 162, 235, 0.8)",
                  "rgba(255, 206, 86, 0.8)",
                  "rgba(75, 192, 192, 0.8)",
                  "rgba(153, 102, 255, 0.8)",
                ],
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: "bottom",
              },
            },
          },
        });

        // Função para adicionar uma nova transação
        document
          .getElementById("saveTransactionButton")
          .addEventListener("click", function () {
            const date = document.getElementById("transactionDate").value;
            const description = document.getElementById(
              "transactionDescription"
            ).value;
            const category = document.getElementById(
              "transactionCategory"
            ).value;
            const amount = parseFloat(
              document.getElementById("transactionAmount").value
            ).toFixed(2);
            const amountClass = amount > 0 ? "text-success" : "text-danger";

            const categoryMap = {
              income: "Renda",
              food: "Alimentação",
              transport: "Transporte",
              utilities: "Utilidades",
              entertainment: "Entretenimento",
            };

            // Função para formatar a data no formato brasileiro
            function formatDate(date) {
              const [year, month, day] = date.split("-");
              return `${day}/${month}/${year}`;
            }

            const newRow = `<tr>
                          <td>${formatDate(date)}</td>
                          <td>${description}</td>
                          <td>${categoryMap[category]}</td>
                          <td class="${amountClass}">${
              amount > 0 ? "+" : ""
            }R$ ${amount}</td>
                        </tr>`;

            document
              .getElementById("transactionTableBody")
              .insertAdjacentHTML("beforeend", newRow);
            document.getElementById("transactionForm").reset();
            const modal = bootstrap.Modal.getInstance(
              document.getElementById("addTransactionModal")
            );
            modal.hide();
          });
      });
    </script>
  </body>
</html>
